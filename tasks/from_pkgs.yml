---
# Ubuntu
- name: repository (Ubuntu)
  ansible.builtin.apt_repository: repo="ppa:cz.nic-labs/knot-dns" state=present
  when: ansible_distribution == "Ubuntu"

# Debian
- name: repository keys (Debian)
  ansible.builtin.apt_key: url=https://deb.knot-dns.cz/knot/apt.gpg state=present
  when: ansible_distribution == "Debian"
- name: repository (Debian)
  ansible.builtin.apt_repository: repo="deb https://deb.knot-dns.cz/knot/ {{ ansible_lsb.codename }} main" state=present
  when: ansible_distribution == "Debian"

# Debian Family (Debian, Ubuntu)
- name: packages (Debian/Ubuntu)
  ansible.builtin.apt: pkg=knot update_cache=yes state=present
  when: ansible_os_family == "Debian"

# FreeBSD Family
- name: packages (FreeBSD)
  community.general.pkgng: name={{ item }} state=present
  with_items:
    - dns/knot2
  when: ansible_os_family == "FreeBSD"

# RedHat Family (RedHat, Fendora, CentOS, Amazon, etc)
- name: packages (RedHat)
  ansible.builtin.yum: >
    name=knot
    state=present
  when: ansible_os_family == "RedHat"
